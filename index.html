<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML to PDF Converter with Claude</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

```
    body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
    }

    .container {
        max-width: 1400px;
        margin: 0 auto;
    }

    .header {
        background: white;
        border-radius: 16px;
        padding: 30px;
        margin-bottom: 30px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }

    .header-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 20px;
    }

    .header-title {
        display: flex;
        align-items: center;
        gap: 15px;
    }

    .icon {
        background: #667eea;
        padding: 12px;
        border-radius: 12px;
        color: white;
        font-size: 24px;
    }

    .title {
        font-size: 28px;
        font-weight: bold;
        color: #2d3748;
    }

    .subtitle {
        color: #718096;
        margin-top: 5px;
    }

    .button-group {
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
    }

    .btn {
        padding: 12px 24px;
        border: none;
        border-radius: 10px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 8px;
        text-decoration: none;
    }

    .btn-primary {
        background: #667eea;
        color: white;
    }

    .btn-primary:hover {
        background: #5a67d8;
        transform: translateY(-2px);
    }

    .btn-secondary {
        background: #48bb78;
        color: white;
    }

    .btn-secondary:hover {
        background: #38a169;
        transform: translateY(-2px);
    }

    .btn-ai {
        background: #ed8936;
        color: white;
    }

    .btn-ai:hover {
        background: #dd6b20;
        transform: translateY(-2px);
    }

    .btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none !important;
    }

    .main-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 30px;
    }

    .panel {
        background: white;
        border-radius: 16px;
        overflow: hidden;
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }

    .panel-header {
        background: #f7fafc;
        padding: 20px 30px;
        border-bottom: 1px solid #e2e8f0;
        font-weight: 600;
        color: #2d3748;
    }

    .panel-content {
        padding: 30px;
    }

    .editor {
        width: 100%;
        height: 400px;
        font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        font-size: 14px;
        border: 2px solid #e2e8f0;
        border-radius: 8px;
        padding: 20px;
        resize: vertical;
        outline: none;
        transition: border-color 0.3s ease;
    }

    .editor:focus {
        border-color: #667eea;
    }

    .preview {
        border: 2px solid #e2e8f0;
        border-radius: 8px;
        padding: 20px;
        min-height: 400px;
        background: white;
        overflow: auto;
    }

    .ai-section {
        background: white;
        border-radius: 16px;
        padding: 30px;
        margin-top: 30px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }

    .ai-input {
        width: 100%;
        padding: 15px;
        border: 2px solid #e2e8f0;
        border-radius: 8px;
        font-size: 16px;
        margin-bottom: 15px;
        outline: none;
        transition: border-color 0.3s ease;
    }

    .ai-input:focus {
        border-color: #ed8936;
    }

    .instructions {
        background: white;
        border-radius: 16px;
        padding: 30px;
        margin-top: 30px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }

    .instructions h3 {
        color: #2d3748;
        margin-bottom: 20px;
        font-size: 20px;
    }

    .instructions-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 25px;
    }

    .instruction-item h4 {
        color: #4a5568;
        margin-bottom: 10px;
        font-weight: 600;
    }

    .instruction-item p {
        color: #718096;
        line-height: 1.6;
    }

    .status {
        padding: 10px 15px;
        border-radius: 6px;
        margin: 10px 0;
        font-weight: 500;
    }

    .status.success {
        background: #c6f6d5;
        color: #22543d;
    }

    .status.error {
        background: #fed7d7;
        color: #742a2a;
    }

    .status.info {
        background: #bee3f8;
        color: #2a4365;
    }

    @media (max-width: 768px) {
        .main-grid {
            grid-template-columns: 1fr;
        }
        
        .header-content {
            flex-direction: column;
            text-align: center;
        }
        
        .instructions-grid {
            grid-template-columns: 1fr;
        }
    }

    .claude-response {
        background: #f7fafc;
        border: 1px solid #e2e8f0;
        border-radius: 8px;
        padding: 15px;
        margin-top: 15px;
        white-space: pre-wrap;
        font-family: monospace;
    }
</style>
```

</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-content">
                <div class="header-title">
                    <div class="icon">üìÑ</div>
                    <div>
                        <div class="title">HTML to PDF Converter</div>
                        <div class="subtitle">Self-hosted with Claude AI integration</div>
                    </div>
                </div>
                <div class="button-group">
                    <button class="btn btn-secondary" onclick="togglePreview()">
                        üëÅÔ∏è Toggle Preview
                    </button>
                    <button class="btn btn-primary" onclick="generatePDF()" id="exportBtn">
                        ‚¨áÔ∏è Export PDF
                    </button>
                </div>
            </div>
        </div>

```
    <!-- Main Content -->
    <div class="main-grid" id="mainGrid">
        <!-- HTML Editor -->
        <div class="panel">
            <div class="panel-header">üìù HTML Editor</div>
            <div class="panel-content">
                <textarea class="editor" id="htmlEditor" placeholder="Enter your HTML code here..."><!DOCTYPE html>
```

<html>
<head>
    <title>Sample Document</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 40px;
            color: #333;
        }
        h1 {
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        .highlight {
            background-color: #f39c12;
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
        }
        .info-box {
            background: #ecf0f1;
            padding: 15px;
            border-left: 4px solid #3498db;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <h1>My Professional Document</h1>
    <p>This is a <span class="highlight">sample document</span> that demonstrates HTML to PDF conversion.</p>

```
<div class="info-box">
    <h3>Key Features:</h3>
    <ul>
        <li>‚úÖ Full HTML and CSS support</li>
        <li>‚úÖ Self-hosted solution</li>
        <li>‚úÖ Claude AI integration</li>
        <li>‚úÖ Mobile-friendly</li>
    </ul>
</div>

<h2>Document Content</h2>
<p>You can include any HTML content here including styled text, tables, images, and more.</p>

<table border="1" style="border-collapse: collapse; width: 100%; margin: 20px 0;">
    <tr style="background: #3498db; color: white;">
        <th style="padding: 10px;">Feature</th>
        <th style="padding: 10px;">Status</th>
    </tr>
    <tr>
        <td style="padding: 10px;">PDF Export</td>
        <td style="padding: 10px;">‚úÖ Working</td>
    </tr>
    <tr>
        <td style="padding: 10px;">Claude Integration</td>
        <td style="padding: 10px;">‚úÖ Available</td>
    </tr>
</table>
```

</body>
</html></textarea>
                </div>
            </div>

```
        <!-- Preview -->
        <div class="panel" id="previewPanel">
            <div class="panel-header">üëÅÔ∏è Live Preview</div>
            <div class="panel-content">
                <div class="preview" id="htmlPreview"></div>
            </div>
        </div>
    </div>

    <!-- Claude AI Integration -->
    <div class="ai-section">
        <h3 style="color: #2d3748; margin-bottom: 20px;">ü§ñ Claude AI Assistant</h3>
        <p style="color: #718096; margin-bottom: 20px;">Ask Claude to help you generate or improve your HTML content:</p>
        
        <input type="text" class="ai-input" id="claudeInput" placeholder="e.g., 'Create a professional invoice template' or 'Add a contact form to my HTML'">
        
        <div class="button-group">
            <button class="btn btn-ai" onclick="askClaude()" id="claudeBtn">
                üß† Ask Claude
            </button>
            <button class="btn btn-secondary" onclick="insertClaudeResponse()" id="insertBtn" style="display: none;">
                ‚ú® Insert into Editor
            </button>
        </div>
        
        <div id="claudeResponse" style="display: none;"></div>
        <div id="statusMessage"></div>
    </div>

    <!-- Instructions -->
    <div class="instructions">
        <h3>üìã How to Use & Host Yourself</h3>
        <div class="instructions-grid">
            <div class="instruction-item">
                <h4>üè† Self-Hosting</h4>
                <p>Save this HTML file and host it on any web server (GitHub Pages, Netlify, Vercel, or your own server). It works completely standalone!</p>
            </div>
            <div class="instruction-item">
                <h4>üîë Claude API Setup</h4>
                <p>Get your API key from console.anthropic.com, then add it to the script below. The AI features will then work perfectly.</p>
            </div>
            <div class="instruction-item">
                <h4>üì± PDF Export</h4>
                <p>Click "Export PDF" to download your HTML as a PDF file. Works on all devices including iOS Safari with full styling support.</p>
            </div>
            <div class="instruction-item">
                <h4>üé® Customization</h4>
                <p>Edit the HTML/CSS in the editor, use Claude to generate content, and export professional PDFs instantly.</p>
            </div>
        </div>
    </div>
</div>

<script>
    // Your Claude API key - Add your actual API key here
    const CLAUDE_API_KEY = 'YOUR_API_KEY_HERE'; // Replace with your actual API key
    
    let currentClaudeResponse = '';

    // Update preview when HTML changes
    document.getElementById('htmlEditor').addEventListener('input', updatePreview);
    
    function updatePreview() {
        const htmlCode = document.getElementById('htmlEditor').value;
        const preview = document.getElementById('htmlPreview');
        
        // Extract body content for preview
        const bodyMatch = htmlCode.match(/<body[^>]*>([\s\S]*?)<\/body>/i);
        const styleMatch = htmlCode.match(/<style[^>]*>([\s\S]*?)<\/style>/i);
        
        let previewContent = bodyMatch ? bodyMatch[1] : htmlCode;
        
        if (styleMatch) {
            previewContent = `<style>${styleMatch[1]}</style>${previewContent}`;
        }
        
        preview.innerHTML = previewContent;
    }

    function togglePreview() {
        const grid = document.getElementById('mainGrid');
        const preview = document.getElementById('previewPanel');
        
        if (preview.style.display === 'none') {
            preview.style.display = 'block';
            grid.style.gridTemplateColumns = '1fr 1fr';
        } else {
            preview.style.display = 'none';
            grid.style.gridTemplateColumns = '1fr';
        }
    }

    function generatePDF() {
        const button = document.getElementById('exportBtn');
        button.disabled = true;
        button.innerHTML = '‚è≥ Generating...';
        
        const htmlCode = document.getElementById('htmlEditor').value;
        
        // Create a new window for printing
        const printWindow = window.open('', '_blank');
        
        if (!printWindow) {
            alert('Please allow popups to generate PDFs. Check your browser settings.');
            button.disabled = false;
            button.innerHTML = '‚¨áÔ∏è Export PDF';
            return;
        }
        
        // Extract content and styles
        const tempDiv = document.createElement('div');
        tempDiv.innerHTML = htmlCode;
        
        // Get styles
        const styleElements = tempDiv.querySelectorAll('style');
        let styles = '';
        styleElements.forEach(style => {
            styles += style.innerHTML + '\n';
        });
        
        // Get body content
        let bodyContent = '';
        const bodyElement = tempDiv.querySelector('body');
        if (bodyElement) {
            bodyContent = bodyElement.innerHTML;
        } else {
            bodyContent = htmlCode.replace(/<!DOCTYPE[^>]*>/gi, '')
                               .replace(/<\/?html[^>]*>/gi, '')
                               .replace(/<head[^>]*>[\s\S]*?<\/head>/gi, '')
                               .replace(/<\/?body[^>]*>/gi, '');
        }
        
        // Create optimized HTML for PDF
        const printHTML = `
```

<!DOCTYPE html>

<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        /* Base styles for PDF */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

```
    body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
        line-height: 1.6;
        color: #333;
        padding: 40px;
        max-width: 100%;
        word-wrap: break-word;
        overflow-wrap: break-word;
    }
    
    /* Print-specific styles */
    @media print {
        body {
            margin: 0;
            padding: 20mm;
            font-size: 12pt;
            line-height: 1.5;
        }
        
        @page {
            margin: 20mm;
            size: A4;
        }
        
        h1, h2, h3, h4, h5, h6 {
            page-break-after: avoid;
            margin-top: 20pt;
            margin-bottom: 10pt;
        }
        
        p, div {
            orphans: 3;
            widows: 3;
        }
        
        blockquote {
            page-break-inside: avoid;
            margin: 15pt 0;
            padding: 10pt;
            border-left: 3pt solid #007bff;
            background-color: #f8f9fa !important;
            font-style: italic;
        }
        
        table {
            page-break-inside: avoid;
            border-collapse: collapse;
            width: 100%;
        }
        
        td, th {
            padding: 6pt;
            border: 1pt solid #ddd;
            text-align: left;
        }
        
        img {
            max-width: 100% !important;
            height: auto !important;
        }
    }
    
    /* Screen styles */
    @media screen {
        body {
            background: white;
            min-height: 100vh;
        }
    }
    
    /* Content styles */
    h1, h2, h3, h4, h5, h6 {
        color: #2c3e50;
        margin: 20px 0 15px 0;
    }
    
    p {
        margin: 15px 0;
        text-align: justify;
        hyphens: auto;
    }
    
    blockquote {
        margin: 20px 0;
        padding: 15px;
        border-left: 4px solid #007bff;
        background-color: #f8f9fa;
        font-style: italic;
        border-radius: 4px;
    }
    
    table {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
    }
    
    td, th {
        padding: 10px;
        text-align: left;
        border: 1px solid #ddd;
        word-wrap: break-word;
    }
    
    th {
        background-color: #f2f2f2;
        font-weight: bold;
    }
    
    ul, ol {
        margin: 15px 0;
        padding-left: 30px;
    }
    
    li {
        margin: 5px 0;
    }
    
    /* Custom styles from user */
    ${styles}
    
    /* Override any problematic styles for PDF */
    * {
        word-wrap: break-word !important;
        overflow-wrap: break-word !important;
    }
    
    div, p, span {
        max-width: 100% !important;
    }
</style>
```

</head>
<body>
    ${bodyContent}

```
<script>
    // Auto-print when page loads
    window.onload = function() {
        setTimeout(function() {
            window.print();
        }, 500);
    };
    
    // Close window after printing (optional)
    window.onafterprint = function() {
        setTimeout(function() {
            window.close();
        }, 1000);
    };
</script>
```

</body>
</html>`;

```
        // Write content to new window
        printWindow.document.write(printHTML);
        printWindow.document.close();
        
        // Reset button
        setTimeout(() => {
            button.disabled = false;
            button.innerHTML = '‚¨áÔ∏è Export PDF';
            showStatus('Print dialog opened! On iOS: tap Share ‚Üí Save to Files to create PDF', 'success');
        }, 1000);
    }

    async function askClaude() {
        const input = document.getElementById('claudeInput');
        const button = document.getElementById('claudeBtn');
        const prompt = input.value.trim();
        
        if (!prompt) {
            showStatus('Please enter a question or request for Claude.', 'error');
            return;
        }
        
        if (CLAUDE_API_KEY === 'YOUR_API_KEY_HERE') {
            showStatus('Please add your Claude API key to use AI features. Get one from console.anthropic.com', 'error');
            return;
        }
        
        button.disabled = true;
        button.innerHTML = 'ü§î Thinking...';
        showStatus('Asking Claude...', 'info');
        
        try {
            const response = await fetch('https://api.anthropic.com/v1/messages', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'x-api-key': CLAUDE_API_KEY,
                    'anthropic-version': '2023-06-01'
                },
                body: JSON.stringify({
                    model: 'claude-3-sonnet-20240229',
                    max_tokens: 2000,
                    messages: [{
                        role: 'user',
                        content: `Create HTML content for: ${prompt}. 

                        Please provide complete, well-structured HTML with inline CSS styling. The HTML should be professional and ready to convert to PDF. Include proper styling for print media if relevant.

                        Return ONLY the HTML code, starting with <!DOCTYPE html> and ending with </html>.`
                    }]
                })
            });
            
            if (!response.ok) {
                throw new Error(`API request failed: ${response.status}`);
            }
            
            const data = await response.json();
            currentClaudeResponse = data.content[0].text;
            
            document.getElementById('claudeResponse').innerHTML = `
                <div class="claude-response">${currentClaudeResponse}</div>
            `;
            document.getElementById('claudeResponse').style.display = 'block';
            document.getElementById('insertBtn').style.display = 'inline-flex';
            
            showStatus('Claude responded successfully!', 'success');
            
        } catch (error) {
            showStatus('Error connecting to Claude: ' + error.message, 'error');
            console.error('Claude API Error:', error);
        }
        
        button.disabled = false;
        button.innerHTML = 'üß† Ask Claude';
    }

    function insertClaudeResponse() {
        if (currentClaudeResponse) {
            document.getElementById('htmlEditor').value = currentClaudeResponse;
            updatePreview();
            showStatus('Claude\'s response inserted into editor!', 'success');
        }
    }

    function showStatus(message, type) {
        const statusDiv = document.getElementById('statusMessage');
        statusDiv.innerHTML = `<div class="status ${type}">${message}</div>`;
        setTimeout(() => {
            statusDiv.innerHTML = '';
        }, 5000);
    }

    // Initialize preview
    updatePreview();
</script>
```

</body>
</html>
